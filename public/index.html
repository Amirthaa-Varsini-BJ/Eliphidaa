<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Elphida - React Study Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<!-- React and ReactDOM -->
<script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<!-- Babel for JSX -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
  body {
    background-color: #1f2937; /* Tailwind slate-800 */
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  /* Custom scrollbar styles */
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }
  ::-webkit-scrollbar-track {
    background: #374151; /* slate-700 */
  }
  ::-webkit-scrollbar-thumb {
    background-color: #4f46e5; /* indigo-600 */
    border-radius: 5px;
  }
</style>
</head>
<body>
<div id="root" class="h-screen flex flex-col"></div>

<script type="text/babel">

const { useState, useEffect, useRef } = React;

const semestersData = [
  {
    name: "Semester 1",
    subjects: [
      { id: "core1A", name: "Core Subject 1A" },
      { id: "elec1B", name: "Elective 1B" },
      { id: "lab1C", name: "Lab Session 1C" },
    ],
  },
  { name: "Semester 2", subjects: [] },
  { name: "Semester 3", subjects: [] },
  { name: "Semester 4", subjects: [] },
  { name: "Semester 5", subjects: [] },
  { name: "Semester 6", subjects: [] },
  { name: "Semester 7", subjects: [] },
  { name: "Semester 8", subjects: [] },
];

const videoPlaylists = {
  core1A: [
    { id: "topic1", title: "Topic 1: Introduction", url: "https://www.w3schools.com/html/mov_bbb.mp4" },
    { id: "topic2", title: "Topic 2: Core Concepts", url: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm" },
    { id: "topic3", title: "Topic 3: Advanced Topics", url: "" },
    { id: "topic4", title: "Topic 4: Case Studies", url: "" },
  ],
  elec1B: [
    { id: "e1topic1", title: "Elective 1 Topic 1", url: "" },
  ],
  lab1C: [
    { id: "l1topic1", title: "Lab Session Intro", url: "" },
  ],
};

const notesData = [
  {
    id: 1,
    title: "Comprehensive Notes - Part 1",
    image: "https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/c6f1a901-3440-4d2b-8783-85b79c839da9.png",
    submittedBy: "StudiousStudent",
    rating: 4.7,
    ratingsCount: 140,
    downloadUrl: "#",
  },
  {
    id: 2,
    title: "Comprehensive Notes - Part 2",
    image: "https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/0370b22a-45ac-434d-98da-060ed46d5fdb.png",
    submittedBy: "KnowledgeSeeker",
    rating: 3.7,
    ratingsCount: 115,
    downloadUrl: "#",
  },
  {
    id: 3,
    title: "Summary Notes - Part 1",
    image: "https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e4c8941c-98b7-47ed-9e46-b2507e0462c0.png",
    submittedBy: "Bookworm",
    rating: 4.3,
    ratingsCount: 90,
    downloadUrl: "#",
  },
  {
    id: 4,
    title: "Summary Notes - Part 2",
    image: "https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/d5ba2e7c-fc4f-484f-a04e-fa8e9578ac3e.png",
    submittedBy: "NoteTaker",
    rating: 4.9,
    ratingsCount: 200,
    downloadUrl: "#",
  },
];

// Helper for star rating display
function StarRating({ rating, onRate }) {
  const [hovered, setHovered] = useState(0);
  const stars = [1, 2, 3, 4, 5];

  function displayStar(star) {
    if (hovered >= star) return "text-yellow-400";
    if (!hovered && rating >= star) return "text-yellow-400";
    return "text-gray-400";
  }

  return (
    <div className="flex space-x-1 cursor-pointer" aria-label={`Rate this with 1 to 5 stars, current rating ${rating}`}>
      {stars.map((star) => (
        <svg
          onMouseEnter={() => setHovered(star)}
          onMouseLeave={() => setHovered(0)}
          onClick={() => onRate(star)}
          key={star}
          xmlns="http://www.w3.org/2000/svg"
          className={"h-5 w-5 " + displayStar(star)}
          fill="currentColor"
          viewBox="0 0 20 20"
          role="img"
          aria-hidden="false"
          tabIndex={0}
          onKeyDown={(e)=>{ if(e.key === 'Enter') onRate(star); }}
        >
          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.286 3.97a1 1 0 00.95.69h4.18c.969 0 1.371 1.24.588 1.81l-3.388 2.462a1 1 0 00-.364 1.118l1.287 3.97c.3.922-.755 1.688-1.54 1.118l-3.388-2.461a1 1 0 00-1.175 0l-3.388 2.461c-.784.57-1.838-.196-1.539-1.118l1.287-3.970a1 1 0 00-.364-1.118L2.045 9.398c-.783-.57-.38-1.81.588-1.81h4.18a1 1 0 00.95-.690l1.287-3.970z" />
        </svg>
      ))}
    </div>
  );
}

function Sidebar({ semesters, selectedSemesterIdx, setSelectedSemesterIdx, selectedSubjectId, setSelectedSubjectId }) {
  return (
    <nav className="w-48 bg-slate-700 p-3 min-h-screen overflow-y-auto text-slate-300" aria-label="Semester Navigation">
      <h2 className="mb-2 font-bold text-slate-400">Semesters</h2>
      {semesters.map((semester, i) => {
        const isSelected = i === selectedSemesterIdx;
        return (
          <div key={semester.name} className="mb-2">
            <button
              onClick={() => {
                setSelectedSemesterIdx(i);
                // On semester change, select first subject if exists
                if (semester.subjects.length) {
                  setSelectedSubjectId(semester.subjects[0].id);
                } else {
                  setSelectedSubjectId(null);
                }
              }}
              className={`w-full text-left rounded px-2 py-1 font-semibold ${
                isSelected ? "bg-indigo-600 text-white" : "bg-slate-600 text-slate-300 hover:bg-slate-500"
              }`}
              aria-expanded={isSelected}
              aria-controls={`semester-panel-${i}`}
              aria-current={isSelected ? "true" : "false"}
            >
              {semester.name}
            </button>
            {isSelected && semester.subjects.length > 0 && (
              <ul id={`semester-panel-${i}`} className="pl-4 mt-1 space-y-1" role="list">
                {semester.subjects.map((sub) => (
                  <li key={sub.id}>
                    <button
                      onClick={() => setSelectedSubjectId(sub.id)}
                      className={`block w-full text-left rounded px-2 py-0.5 ${
                        sub.id === selectedSubjectId ? "bg-indigo-500 text-white" : "hover:bg-indigo-700 text-indigo-300"
                      }`}
                      aria-current={sub.id === selectedSubjectId ? "true" : "false"}
                    >
                      {sub.name}
                    </button>
                  </li>
                ))}
              </ul>
            )}
          </div>
        );
      })}
    </nav>
  );
}

function VideoPlayer({ playlist, selectedVideoId, setSelectedVideoId }) {
  // Find the selected video url, fallback if none
  const selectedVideo = playlist.find(v => v.id === selectedVideoId) || playlist[0];
  const videoUrl = selectedVideo?.url || "";

  return (
    <section className="flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:space-x-6 flex-1" aria-label="Video Lectures Player and Playlist">
      <div className="flex-1 bg-slate-600 rounded-md p-4 flex flex-col" aria-live="polite">
        <h3 className="text-indigo-400 font-semibold mb-2">{selectedVideo ? selectedVideo.title : "Select a topic"}</h3>
        {videoUrl ? (
          <video
            key={selectedVideo.id}
            controls
            className="w-full rounded bg-black aspect-video"
            aria-label={`Video player for ${selectedVideo.title}`}
          >
            <source src={videoUrl} type="video/mp4" />
            Sorry, your browser doesn't support embedded videos.
          </video>
        ) : (
          <div className="w-full rounded bg-slate-400 aspect-video flex items-center justify-center text-slate-600 select-none" aria-live="polite">
            Video not available
          </div>
        )}
      </div>
      <aside className="w-48 shrink-0 bg-slate-700 rounded-md p-4 overflow-y-auto max-h-[300px]" aria-label="Playlist">
        <h4 className="font-semibold text-indigo-300 mb-2">Playlist</h4>
        <ul className="space-y-2" role="list">
          {playlist.map((video) => (
            <li key={video.id}>
              <button
                onClick={() => setSelectedVideoId(video.id)}
                className={`block w-full text-left rounded px-3 py-1 ${
                  video.id === selectedVideoId ? "bg-indigo-600 text-white" : "hover:bg-indigo-800 text-indigo-300"
                }`}
                aria-current={video.id === selectedVideoId ? "true" : "false"}
              >
                {video.title}
              </button>
            </li>
          ))}
        </ul>
      </aside>
    </section>
  );
}

function NotesCard({ note, onRate }) {
  const [userRating, setUserRating] = useState(0);

  function handleRate(stars) {
    setUserRating(stars);
    onRate(note.id, stars);
  }

  return (
    <article tabIndex={0} aria-label={`Note titled ${note.title} submitted by ${note.submittedBy}`} className="bg-slate-700 rounded-md overflow-hidden shadow-lg focus:outline-indigo-500 focus:outline-2 focus:outline-offset-2">
      <img
        src={note.image}
        alt={`Image depicting ${note.title}, showing a scenic nature or thematic background`} 
        className="w-full h-32 object-cover"
        onError={(e) => { e.target.onerror=null; e.target.src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/27b98bc0-530e-4091-b8fc-e0efa85d8e93.png"; }}
      />
      <div className="p-3">
        <h5 className="font-semibold text-indigo-400 mb-1 truncate">{note.title}</h5>
        <p className="text-slate-400 text-xs mb-1">Submitted by: <span className="italic">{note.submittedBy}</span></p>
        <p className="text-yellow-400 font-semibold text-sm mb-1">
          ★ {note.rating.toFixed(1)} <span className="text-slate-400 text-xs">({note.ratingsCount} ratings)</span>
        </p>
        <div className="mb-2">
          <p className="text-slate-300 text-sm mb-1">Rate this note:</p>
          <StarRating rating={userRating || note.rating} onRate={handleRate} />
        </div>
        <a
          href={note.downloadUrl}
          download
          className="block w-full text-center bg-indigo-600 hover:bg-indigo-700 text-white rounded py-2 select-none"
          aria-label={`Download ${note.title}`}
          tabIndex={0}
        >
          Download Notes
        </a>
      </div>
    </article>
  );
}

function NotesSection({ notes }) {
  const [ratings, setRatings] = useState({}); // user ratings keyed by note id

  function handleNoteRate(noteId, stars) {
    setRatings(prev => ({ ...prev, [noteId]: stars }));
  }

  return (
    <section aria-labelledby="notes-heading" className="mt-6">
      <h2 id="notes-heading" className="text-indigo-400 font-bold text-lg mb-3 select-none">Handwritten Notes & Materials</h2>
      <div className="grid gap-6 md:grid-cols-2">
        {notes.map(note => (
          <NotesCard key={note.id} note={note} onRate={handleNoteRate} />
        ))}
      </div>
    </section>
  );
}

function CalendarTask({ tasks, selectedDate, addTask }) {
  // Calendar will show one month (current or given month) with ability to navigate
  const [currentDate, setCurrentDate] = useState(selectedDate);
  const [newTaskTitle, setNewTaskTitle] = useState("");

  // Calculate days for month display
  const year = currentDate.getFullYear();
  const month = currentDate.getMonth();

  const startDay = new Date(year, month, 1).getDay();
  const numDays = new Date(year, month + 1, 0).getDate();

  const days = [];
  for (let i = 0; i < startDay; i++) {
    days.push(null); // padding days
  }
  for (let i = 1; i <= numDays; i++) {
    days.push(new Date(year, month, i));
  }

  function handlePrevMonth() {
    const prev = new Date(year, month - 1, 1);
    setCurrentDate(prev);
  }
  function handleNextMonth() {
    const next = new Date(year, month + 1, 1);
    setCurrentDate(next);
  }
  function selectDate(d) {
    setCurrentDate(d);
  }

  // Format date to yyyy-mm-dd for keys
  function formatDateForKey(d) {
    return d.toISOString().slice(0,10);
  }

  // Handle adding task
  function handleAddTask() {
    if (!newTaskTitle.trim()) return;
    addTask(formatDateForKey(currentDate), newTaskTitle.trim());
    setNewTaskTitle("");
  }

  const selectedDateKey = formatDateForKey(currentDate);
  const tasksForDate = tasks[selectedDateKey] || [];

  return (
    <section className="bg-slate-700 rounded-md p-4 max-w-xs" aria-label="Calendar and Tasks">
      <header className="flex justify-between items-center mb-2 text-indigo-400 font-semibold select-none">
        <button
          onClick={handlePrevMonth}
          aria-label="Previous Month"
          className="hover:bg-slate-600 rounded p-1 focus:outline-indigo-300 focus:outline-2"
        >
          <
        </button>
        <h3>{currentDate.toLocaleString('default', { month:'long' })} {year}</h3>
        <button
          onClick={handleNextMonth}
          aria-label="Next Month"
          className="hover:bg-slate-600 rounded p-1 focus:outline-indigo-300 focus:outline-2"
        >
          >
        </button>
      </header>
      <div className="grid grid-cols-7 gap-1 text-center text-xs mb-3 select-none text-slate-400">
        <span>Sun</span><span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span>
      </div>
      <div className="grid grid-cols-7 gap-1 text-center text-sm">
        {days.map((d,i) =>
          d ? (
            <button
              key={i}
              className={`py-1 rounded ${
                d.getDate() === currentDate.getDate() &&
                d.getMonth() === currentDate.getMonth() &&
                d.getFullYear() === currentDate.getFullYear()
                  ? "bg-indigo-600 text-white"
                  : "hover:bg-indigo-800 text-indigo-300"
              } focus:outline-indigo-400 focus:outline-2`}
              onClick={() => selectDate(d)}
              aria-current={d.getDate() === currentDate.getDate() ? "date" : undefined}
              aria-label={`Select day ${d.getDate()}`}
            >
              {d.getDate()}
            </button>
          ) : (
            <div key={i} />
          )
        )}
      </div>
      <div className="mt-3 text-indigo-300 select-none font-semibold">
        Tasks for {currentDate.toLocaleDateString()}
      </div>
      <ul className="mb-3 h-24 overflow-y-auto bg-slate-600 rounded p-2 text-indigo-100 text-sm space-y-1">
        {tasksForDate.length > 0 ? (
          tasksForDate.map((task, idx) => (
            <li key={idx} className="truncate" tabIndex={0}>
              • {task}
            </li>
          ))
        ) : (
          <li className="text-slate-400 italic">No tasks for this day.</li>
        )}
      </ul>
      <div className="flex space-x-2">
        <input
          type="text"
          placeholder="New task title"
          aria-label="New task title input"
          value={newTaskTitle}
          onChange={(e) => setNewTaskTitle(e.target.value)}
          className="flex-grow rounded px-2 py-1 bg-slate-800 text-indigo-300 focus:outline-indigo-400 focus:outline-2"
        />
        <button
          onClick={handleAddTask}
          className="bg-indigo-600 hover:bg-indigo-700 rounded px-3 select-none focus:outline-indigo-300 focus:outline-2"
          aria-label="Add new task"
          disabled={!newTaskTitle.trim()}
        >
          + Add Task
        </button>
      </div>
    </section>
  );
}

function UserMenu({ onLogout }) {
  const [open, setOpen] = useState(false);

  return (
    <div className="relative text-indigo-400">
      <button
        aria-haspopup="true"
        aria-controls="user-menu"
        aria-expanded={open}
        onClick={() => setOpen(!open)}
        className="flex items-center space-x-2 focus:outline-indigo-400 focus:outline-2 rounded hover:bg-slate-700 px-2 py-1"
        aria-label="User menu toggle"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          className="h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          aria-hidden="true"
          focusable="false"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            strokeWidth={2}
            d="M5.121 17.804A9 9 0 1118.879 6.196 9 9 0 015.121 17.804zM15 11a3 3 0 11-6 0 3 3 0 016 0z"
          />
        </svg>
      </button>
      {open && (
        <div
          id="user-menu"
          role="menu"
          aria-label="User Settings"
          className="absolute right-0 top-full mt-1 w-48 rounded-md bg-slate-700 shadow-lg text-indigo-300 z-30 ring-1 ring-black ring-opacity-5"
          onBlur={(e) => {
            // Close menu when focus moves outside this element
            if (!e.currentTarget.contains(e.relatedTarget)) {
              setOpen(false);
            }
          }}
          tabIndex={-1}
        >
          <ul>
            <li>
              <button
                className="block w-full text-left px-4 py-2 hover:bg-slate-600"
                role="menuitem"
                onClick={() => alert("Upload Notes clicked")}
              >
                Upload Notes
              </button>
            </li>
            <li>
              <button
                className="block w-full text-left px-4 py-2 hover:bg-slate-600"
                role="menuitem"
                onClick={() => alert("Progress clicked")}
              >
                Progress
              </button>
            </li>
            <li>
              <button
                className="block w-full text-left px-4 py-2 hover:bg-slate-600"
                role="menuitem"
                onClick={() => alert("Light Mode toggled")}
              >
                Light Mode
              </button>
            </li>
            <li>
              <button
                className="block w-full text-left px-4 py-2 text-indigo-500 hover:bg-slate-600"
                role="menuitem"
                onClick={() => {
                  setOpen(false);
                  onLogout();
                }}
              >
                Logout
              </button>
            </li>
          </ul>
        </div>
      )}
    </div>
  );
}

function StudyRoomsSection() {
  const [rooms, setRooms] = useState([]);
  const [newRoomId, setNewRoomId] = useState("");
  const [joinRoomId, setJoinRoomId] = useState("");
  const [chatLog, setChatLog] = useState([]);
  const [chatInput, setChatInput] = useState("");
  const [activeRoomId, setActiveRoomId] = useState(null);

  function addNewRoom() {
    if (!newRoomId.trim()) return;
    if (rooms.includes(newRoomId.trim())) {
      alert("Room ID already exists.");
      return;
    }
    setRooms((prev) => [...prev, newRoomId.trim()]);
    setNewRoomId("");
    setActiveRoomId(newRoomId.trim());
    setChatLog([]);
  }

  function joinRoom() {
    if (!joinRoomId.trim()) return;
    if (!rooms.includes(joinRoomId.trim())) {
      alert("Room ID not found.");
      return;
    }
    setActiveRoomId(joinRoomId.trim());
    setChatLog([]);
    setJoinRoomId("");
  }

  function sendMessage() {
    if (!chatInput.trim() || !activeRoomId) return;
    setChatLog((prev) => [...prev, { user: "You", message: chatInput.trim() }]);
    setChatInput("");
  }

  return (
    <section className="bg-slate-700 rounded-md p-4 max-w-xs flex flex-col space-y-4" aria-label="Study Rooms Chat">
      <h3 className="text-indigo-400 font-semibold mb-2 select-none">Study Rooms</h3>
      <div>
        <button
          onClick={addNewRoom}
          className="bg-indigo-600 hover:bg-indigo-700 rounded px-3 py-2 w-full mb-2 select-none focus:outline-indigo-300 focus:outline-2"
          aria-label="Add New Room"
          disabled={!newRoomId.trim()}
        >
          + Add New Room
        </button>
        <input
          type="text"
          placeholder="Enter New Room ID"
          aria-label="New Room ID input"
          value={newRoomId}
          onChange={(e) => setNewRoomId(e.target.value)}
          className="w-full rounded px-2 py-1 bg-slate-800 text-indigo-300 focus:outline-indigo-400 focus:outline-2"
        />
      </div>
      <div>
        <button
          onClick={joinRoom}
          className="bg-indigo-600 hover:bg-indigo-700 rounded px-3 py-2 w-full mb-2 select-none focus:outline-indigo-300 focus:outline-2"
          aria-label="Join Room"
          disabled={!joinRoomId.trim()}
        >
          Join Room
        </button>
        <input
          type="text"
          placeholder="Enter Room ID to Join"
          aria-label="Join Room ID input"
          value={joinRoomId}
          onChange={(e) => setJoinRoomId(e.target.value)}
          className="w-full rounded px-2 py-1 bg-slate-800 text-indigo-300 focus:outline-indigo-400 focus:outline-2"
        />
      </div>

      {activeRoomId ? (
        <div className="flex flex-col bg-slate-800 rounded p-3 flex-grow">
          <div className="mb-1 font-semibold text-indigo-300 select-none truncate" title={activeRoomId}>
            Chat Room: {activeRoomId}
          </div>
          <div
            className="flex-grow overflow-y-auto bg-slate-900 p-2 rounded mb-2 text-indigo-200 space-y-1"
            aria-live="polite"
            aria-relevant="additions"
            role="log"
          >
            {chatLog.length === 0 ? (
              <p className="italic text-slate-500 select-none">No messages yet.</p>
            ) : (
              chatLog.map((msg, idx) => (
                <p key={idx}>
                  <span className="font-semibold">{msg.user}:</span> {msg.message}
                </p>
              ))
            )}
          </div>
          <div className="flex space-x-2">
            <input
              type="text"
              aria-label="Type your message"
              placeholder="Type your message"
              value={chatInput}
              onChange={(e) => setChatInput(e.target.value)}
              onKeyDown={(e) => {
                if (e.key === "Enter") sendMessage();
              }}
              className="flex-grow rounded px-2 py-1 bg-slate-700 text-indigo-300 focus:outline-indigo-400 focus:outline-2"
            />
            <button
              onClick={sendMessage}
              className="bg-indigo-600 hover:bg-indigo-700 rounded px-3 select-none focus:outline-indigo-300 focus:outline-2"
              aria-label="Send message"
              disabled={!chatInput.trim()}
            >
              Send
            </button>
          </div>
        </div>
      ) : (
        <p className="text-slate-400 font-semibold select-none">Join or create a room to start chatting.</p>
      )}
    </section>
  );
}

function App() {
  const [selectedSemesterIdx, setSelectedSemesterIdx] = useState(0);
  const [selectedSubjectId, setSelectedSubjectId] = useState(
    semestersData[0].subjects.length > 0 ? semestersData[0].subjects[0].id : null
  );
  const [selectedVideoId, setSelectedVideoId] = useState(videoPlaylists.core1A[0]?.id || null);
  const [tasks, setTasks] = useState({});
  const [userLoggedIn, setUserLoggedIn] = useState(true);

  // Sync selectedVideoId when selectedSubjectId changes
  useEffect(() => {
    if (selectedSubjectId && videoPlaylists[selectedSubjectId]) {
      setSelectedVideoId(videoPlaylists[selectedSubjectId][0]?.id || null);
    } else {
      setSelectedVideoId(null);
    }
  }, [selectedSubjectId]);

  // Add task handler
  function addTask(dateKey, title) {
    setTasks((prev) => {
      const currentTasks = prev[dateKey] || [];
      return { ...prev, [dateKey]: [...currentTasks, title] };
    });
  }

  function handleLogout() {
    alert("Logged out!");
    setUserLoggedIn(false);
  }

  if (!userLoggedIn) {
    return (
      <div className="w-full h-screen flex items-center justify-center text-indigo-400 select-none">
        <div className="text-center">
          <h1 className="text-3xl mb-4">You have logged out.</h1>
          <button
            className="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded"
            onClick={() => setUserLoggedIn(true)}
          >
            Log In Again
          </button>
        </div>
      </div>
    );
  }

  const selectedSemester = semestersData[selectedSemesterIdx];
  const playlist = selectedSubjectId ? (videoPlaylists[selectedSubjectId] || []) : [];

  return (
    <div className="flex h-screen text-slate-300">
      {/* Sidebar */}
      <Sidebar
        semesters={semestersData}
        selectedSemesterIdx={selectedSemesterIdx}
        setSelectedSemesterIdx={setSelectedSemesterIdx}
        selectedSubjectId={selectedSubjectId}
        setSelectedSubjectId={setSelectedSubjectId}
      />

      {/* Main content */}
      <main className="flex flex-col flex-1 overflow-y-auto p-6 space-y-6 bg-slate-800">
        <header className="flex justify-between items-center">
          <h1 className="text-2xl font-bold text-indigo-400 select-none">Elphida</h1>
          <UserMenu onLogout={handleLogout} />
        </header>

        {/* Video Lectures Section */}
        {selectedSubjectId ? (
          <section aria-label="Video Lectures Section">
            <h2 className="text-indigo-400 font-semibold mb-3 select-none">
              {selectedSemester.name} - {semestersData[selectedSemesterIdx].subjects.find(s => s.id === selectedSubjectId)?.name} - Video Lectures
            </h2>
            <VideoPlayer
              playlist={playlist}
              selectedVideoId={selectedVideoId}
              setSelectedVideoId={setSelectedVideoId}
            />
          </section>
        ) : (
          <p className="text-indigo-400 font-semibold select-none">No subjects available in this semester.</p>
        )}

        {/* Notes Section */}
        <NotesSection notes={notesData} />
      </main>

      {/* Right sidebar */}
      <aside className="w-72 p-6 bg-slate-700 overflow-y-auto space-y-6">
        <CalendarTask tasks={tasks} selectedDate={new Date()} addTask={addTask} />
        <StudyRoomsSection />
      </aside>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);

</script>
</body>
</html>

